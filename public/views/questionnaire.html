<md-content class="md-padding" layout="row" ng-init="service.isTeacher()" ng-show="!loading">
	<md-button class="md-fab" ng-click="create()" aria-label="Lisa uus">
		<md-icon class="material-icons">create</md-icon>
		<md-tooltip md-visible="demo.showTooltip" md-direction="{{demo.tipDirection}}">
			Lisa uus!
		</md-tooltip>
	</md-button>
	<div layout="column" flex="20">
		<md-list>
			<md-subheader class="md-no-sticky"></md-subheader>
			<md-list-item class="md-3-line" ng-repeat="item in questionnaires" ng-click="view(item)">
				<div class="md-list-item-text" layout="column">
					<h4>
										Pealkiri: {{item.title}}
									</h4>
					<p>
						Aeg mis kulub: {{item.totalTime}}
					</p>
					<p>
						Maksimum punktid: {{item.totalPoints}}
					</p>
					<p>
						Loodud: {{item.createdDate | date:'MM/dd/yyyy @ h:mm'}}
					</p>
				</div>
			</md-list-item>
			<md-divider></md-divider>
		</md-list>
	</div>
	<div layout="column" flex>
		<div ng-if="activeQuestionnaire.title">
			<div class="md-block" flex-gt-sm>
				<md-input-container>
					<label>Pealkiri</label>
					<input ng-model="activeQuestionnaire.title">
				</md-input-container>
				<md-input-container>
					<label>Täitmise aeg</label>
					<input ng-model="activeQuestionnaire.totalTime" type="number" step="1" min="0" max="360000">
				</md-input-container>
				<md-button class="md-raised md-primary" ng-click="update(activeQuestionnaire)">Salvesta</md-button>
				<md-button class="md-raised md-warn" ng-click="delete(activeQuestionnaire)">Kustuta</md-button>
				<div layout="row">
					<md-input-container class="md-block" flex-gt-sm>
						<label>Loodud:</label>
						<input ng-model="activeQuestionnaire.createdDate | date:'MM/dd/yyyy @ h:mm'" readonly>
					</md-input-container>
					<md-input-container class="md-block" flex-gt-sm>
						<label>Viimati salvestatud:</label>
						<input ng-model="activeQuestionnaire.saved | date:'MM/dd/yyyy @ h:mm'" readonly>
					</md-input-container>
				</div>
			</div>
			<center class="md.title">Küsimused:</center>
			<md-divider></md-divider>
			<md-list-item ng-repeat="x in activeQuestionnaire.questions track by $index" ng-click="viewQuestion(x)">
				<div layout="row" flex>
						<span flex="50">{{x.title}}</span>
						<span flex>{{x.type}}</span>
						<span>{{x.maxPoints}}</span>
				</div>
			</md-list-item>
		</div>
	</div>
	<div layout="column" flex="40">
		<div layout="row" class="md-block">
			<md-input-container>
				<label>Küsimus</label>
				<input ng-model="activeQuestion.title">
			</md-input-container>
			<!-- Loogika küsimuse lisamiseks -->
			<div>
				<md-input-container>
					<label>Tüüp</label>
					<md-select ng-model="activeQuestion.type" ng-change="clear(activeQuestion)">
						<md-option>
							Valik
						</md-option>
						<md-option>
							Tühi lünk
						</md-option>
					</md-select>
				</md-input-container>
				<md-button class="md-raised md-primary" ng-disabled="!(activeQuestion.type && activeQuestion.variants.length > 0 && activeQuestion.title && activeQuestion.maxPoints)" ng-click="addQuestion(activeQuestion)">Lisa küsimus</md-button>
			</div>
			<!-- Muutub vastavalt küsimuse tüübile -->
		</div>
		<div layout="row" class="md-block" flex>
			<div ng-if="activeQuestion.type=='Valik'" flex>
				<div ng-if="activeQuestion.variants.length > 0">
					<center class="md-headline">Vastuse variandid</center>
					<md-divider></md-divider>
					<table style="width:100%">
						<tr>
							<th>Variant</th>
							<th>Punktid</th>
							<th>Kustuta</th>
						</tr>
						<!-- Kui vastuse boolean on tõene - roheline taust -->
						<tr ng-repeat="y in activeQuestion.variants track by $index" ng-if="y.bool" bgcolor="#4CAF50">
							<td>{{y.answer}}</td>
							<td>{{y.points}}</td>
							<td>
								<md-button class="md-icon-button md-secondary" ng-click="remVariant(activeQuestion, y)">
									<md-icon class="material-icons">close</md-icon>
								</md-button>
							</td>
						</tr>
						<!-- Kui vastuse boolean on tõene - punane taust -->
						<tr ng-repeat="y in activeQuestion.variants track by $index" ng-if="!y.bool" bgcolor="#F44336">
							<td>{{y.answer}}</td>
							<td>{{y.points}}</td>
							<td>
								<md-button class="md-icon-button md-secondary" ng-click="remVariant(activeQuestion, y)">
									<md-icon class="material-icons">close</md-icon>
								</md-button>
							</td>
						</tr>
					</table>
				</div>
				<md-input-container>
					<label>Vastus</label>
					<input ng-model="variant.answer">
				</md-input-container>
				<md-input-container>
					<label>Punktid</label>
					<input ng-model="variant.points" ng-init="variant.points=0" type="number" step="0.5" min="-100" max="100">
				</md-input-container>
				<md-checkbox ng-model="variant.bool" aria-label="Õige/Vale" ng-init="variant.bool=true"></md-checkbox>
				<md-card-action>
					<md-button class="md-raised md-accent" ng-disabled="!(variant.answer && variant.points >= -100 && variant.points <= 100)" ng-click="addVariant(activeQuestion, variant)">Lisa vastus</md-button>
				</md-card-action>
			</div>
			<div ng-if="activeQuestion.type=='Tühi lünk'" class="md-block">
				<md-input-container flex>
					<label>Vastus</label>
					<input ng-model="activeQuestion.variants">
				</md-input-container>
				<md-input-container flex>
					<label>Punktid</label>
					<input ng-model="activeQuestion.maxPoints" ng-init="activeQuestion.maxPoints=0" type="number" step="0.5" min="-100" max="100">
				</md-input-container>
			</div>
		</div>
	</div>
</md-content>
