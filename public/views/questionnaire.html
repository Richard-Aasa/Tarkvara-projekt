<md-content class="md-padding" layout="row" ng-init="service.isTeacher()" ng-show="!loading">
	<md-button class="md-fab" ng-click="create()" aria-label="Lisa uus">
		<md-icon class="material-icons">create</md-icon>
		<md-tooltip>
			Lisa uus!
		</md-tooltip>
	</md-button>
	<div layout="column" flex="25">
				<md-list>

			<md-subheader class="md-no-sticky"></md-subheader>
				<h2>Küsimustikud</h2>
			<md-list-item class="md-3-line" ng-repeat="item in questionnaires" ng-click="view(item)">
				<div class="md-list-item-text" layout="column">
					<p><b>{{item.title}}</b>

					</p>
					<div class="itemPadding">
						<p>
							<md-icon class="material-icons">timer</md-icon>
							{{item.totalTime}}
							<md-icon class="material-icons">star_rate</md-icon>
							{{item.totalPoints}}
						</p>
						<p>
							<md-icon class="material-icons">date_range</md-icon>
							{{item.saved | date:'MM/dd/yyyy @ h:mm'}}
						</p>
						<md-divider></md-divider>
					</div>
				</div>
			</md-list-item>

		</md-list>
	</div>
	<md-card layout-padding layout="column" ng-if="activeQuestionnaire.title">
		<div class="md-block" flex-gt-sm>
				<h2>Küsimustiku haldus</h2>
			<md-input-container>
				<label>Pealkiri</label>
				<input ng-model="activeQuestionnaire.title">
			</md-input-container>
			<md-input-container>
				<label>Aeg minutites</label>
				<input ng-model="activeQuestionnaire.totalTime" type="number" step="1" min="0" max="1888900">
			</md-input-container>
			Küsimustiku punktid:{{activeQuestionnaire.totalPoints}}
			<div layout="row" layout-align="center center">
				<div layout="column">
					<div class="md-block md-body-2">Loodud: {{activeQuestionnaire.createdDate | date:'MM/dd/yyyy @ h:mm'}}</div>
					<md-divider></md-divider>
					<div class="md-block md-body-2">Salvestatud: {{activeQuestionnaire.saved | date:'MM/dd/yyyy @ h:mm'}}</div>
				</div>
				<md-button class="md-raised md-primary" ng-click="update(activeQuestionnaire)">Salvesta</md-button>
				<md-button class="md-raised md-warn" ng-click="delete(activeQuestionnaire)">Kustuta</md-button>
			</div>
			<br><br><br>
			<center class="md-title">Küsimused</center>
			<br>
			<md-divider></md-divider>
			<table class="kysimustik" width="100%">
					<tr style="border-top: 1px solid rgba(0, 0, 0, 0.12)" ng-repeat="x in activeQuestionnaire.questions track by $index">
						<td class="kysimustik">
							<md-list-item ng-click="viewQuestion(x)">
									<span flex="40">{{x.title}}</span>
									<span flex>{{x.type}}</span>
									<span>{{x.maxPoints}}</span>
							<md-list-item>
						</td>
						<td class="kysimustik">
							<md-button ng-click="remQuestion(x)" class="md-icon md-warn">
								<md-icon>close</md-icon>
							</md-button>
						</td>
					</tr>
			</table>
			<md-divider></md-divider>
		</div>
	</md-card>

	<md-card layout-padding layout="column" ng-if="activeQuestion.title" layout-align="start left" flex>
<h2>Küsimuse haldus</h2>
		<div layout="row" class="md-block">

			<md-input-container>
				<label>Küsimus</label>
				<input ng-model="activeQuestion.title">
			</md-input-container>
			<!-- Loogika küsimuse lisamiseks -->
			<div>

				<md-input-container>
					<label>Tüüp</label>
					<md-select ng-model="activeQuestion.type" ng-change="clear(activeQuestion)">
						<md-option>
							Valik
						</md-option>
						<md-option>
							Tühi lünk
						</md-option>
					</md-select>
				</md-input-container>
			</div>
			<!-- Muutub vastavalt küsimuse tüübile -->
		</div>
		<div layout="row" class="md-block">
			<div ng-if="activeQuestion.type=='Valik'" flex>
				<div ng-if="activeQuestion.variants.length > 0">
					<center class="md-headline">Vastuse variandid</center>
					<md-divider></md-divider>
					<table style="width:100%">
						<tr>
							<th>Variant</th>
							<th>Punktid</th>
							<th>Kustuta</th>
						</tr>
						<!-- Kui vastuse boolean on tõene - roheline taust -->
						<tr ng-repeat="y in activeQuestion.variants track by $index" ng-if="y.bool" bgcolor="#88C474">
							<td>{{y.answer}}</td>
							<td>{{y.points}}</td>
							<td>
								<md-button class="md-icon-button md-secondary" ng-click="remVariant(activeQuestion, y)">
									<md-icon class="material-icons">close</md-icon>
								</md-button>
							</td>
						</tr>
						<!-- Kui vastuse boolean on tõene - punane taust -->
						<tr ng-repeat="y in activeQuestion.variants track by $index" ng-if="!y.bool" bgcolor="#C95D5D">
							<td>{{y.answer}}</td>
							<td>{{y.points}}</td>
							<td>
								<md-button class="md-icon-button md-secondary" ng-click="remVariant(activeQuestion, y)">
									<md-icon class="material-icons">close</md-icon>
								</md-button>
							</td>
						</tr>
					</table>
				</div>
				<md-input-container>
					<label>Vastus</label>
					<input ng-model="variant.answer">
				</md-input-container>
				<md-input-container>
					<label>Punktid</label>
					<input ng-model="variant.points" ng-init="variant.points=0" type="number" step="0.5" min="-100" max="100">
				</md-input-container>
				<md-checkbox class="green" ng-model="variant.bool" aria-label="Õige/Vale" ng-init="variant.bool=true"></md-checkbox>
				<md-card-action>
					<md-button class="md-raised md-accent" ng-disabled="!(variant.answer && variant.points >= -100 && variant.points <= 100)" ng-click="addVariant(activeQuestion, variant)">Lisa vastus</md-button>
				</md-card-action>
			</div>
			<div ng-if="activeQuestion.type=='Tühi lünk'" class="md-block">
				<md-input-container flex>
					<label>Vastus</label>
					<input ng-model="activeQuestion.variants">
				</md-input-container>
				<md-input-container flex>
					<label>Punktid</label>
					<input ng-model="activeQuestion.maxPoints" ng-init="question.maxPoints=0" type="number" step="0.5" min="-100" max="100">
				</md-input-container>
			</div>

		</div>
		<div layout="row" layout-align="center center">
			<md-button class="md-raised md-primary" ng-disabled="!(activeQuestion.type && activeQuestion.variants.length > 0 && activeQuestion.title && activeQuestion.maxPoints)" ng-click="addQuestion(activeQuestion)">Lisa küsimus</md-button>
			<md-button class="md-raised md-accent" ng-disabled="!(activeQuestion.type && activeQuestion.variants.length > 0 && activeQuestion.title && activeQuestion.maxPoints)" ng-click="editQuestion(activeQuestion)">Muuda</md-button>
			<span>Max punktid: {{activeQuestion.maxPoints}}</span>
		</div>
	</md-card>
</md-content>
